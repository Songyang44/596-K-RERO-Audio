"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SolidLdoProvider = exports.useLdo = exports.SolidLdoReactContext = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_2 = require("react");
const SolidAuthContext_1 = require("./SolidAuthContext");
const solid_1 = require("@ldo/solid");
const useLdoMethods_1 = require("./useLdoMethods");
exports.SolidLdoReactContext = (0, react_1.createContext)(undefined);
function useLdo() {
    return (0, react_1.useContext)(exports.SolidLdoReactContext);
}
exports.useLdo = useLdo;
const SolidLdoProvider = ({ children, }) => {
    const { fetch } = (0, SolidAuthContext_1.useSolidAuth)();
    const solidLdoDataset = (0, react_2.useMemo)(() => {
        const ldoDataset = (0, solid_1.createSolidLdoDataset)({
            fetch,
        });
        ldoDataset.setMaxListeners(1000);
        return ldoDataset;
    }, []);
    (0, react_2.useEffect)(() => {
        solidLdoDataset.context.fetch = fetch;
    }, [fetch]);
    const value = (0, react_2.useMemo)(() => (0, useLdoMethods_1.createUseLdoMethods)(solidLdoDataset), [solidLdoDataset]);
    return ((0, jsx_runtime_1.jsx)(exports.SolidLdoReactContext.Provider, { value: value, children: children }));
};
exports.SolidLdoProvider = SolidLdoProvider;
//# sourceMappingURL=SolidLdoProvider.js.map