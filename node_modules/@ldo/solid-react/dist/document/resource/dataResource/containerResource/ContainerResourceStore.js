"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ContainerResourceStore = void 0;
const DocumentStore_1 = require("../../../DocumentStore");
const ContainerResource_1 = require("./ContainerResource");
class ContainerResourceStore extends DocumentStore_1.DocumentStore {
    create(initializer) {
        return new ContainerResource_1.ContainerResource(initializer, this.dependencies);
    }
    normalizeInitializer(initializer) {
        return ContainerResource_1.ContainerResource.normalizeUri(initializer);
    }
    getContainerForResouce(resource) {
        const parentUri = ContainerResourceStore.getParentUri(resource.uri);
        return parentUri ? this.get(parentUri) : undefined;
    }
    static getParentUri(uri) {
        const urlObject = new URL(uri);
        const pathItems = urlObject.pathname.split("/");
        if (pathItems.length < 2 ||
            (pathItems.length === 2 && pathItems[1].length === 0)) {
            return undefined;
        }
        if (pathItems[pathItems.length - 1] === "") {
            pathItems.pop();
        }
        pathItems.pop();
        urlObject.pathname = `${pathItems.join("/")}/`;
        return urlObject.toString();
    }
}
exports.ContainerResourceStore = ContainerResourceStore;
//# sourceMappingURL=ContainerResourceStore.js.map