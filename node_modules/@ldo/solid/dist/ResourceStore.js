"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ResourceStore = void 0;
const Container_1 = require("./resource/Container");
const Leaf_1 = require("./resource/Leaf");
const uriTypes_1 = require("./util/uriTypes");
class ResourceStore {
    constructor(context) {
        this.resourceMap = new Map();
        this.context = context;
    }
    get(uri, options) {
        const url = new URL(uri);
        url.hash = "";
        const normalizedUri = url.toString();
        let resource = this.resourceMap.get(normalizedUri);
        if (!resource) {
            if ((0, uriTypes_1.isContainerUri)(normalizedUri)) {
                resource = new Container_1.Container(normalizedUri, this.context);
            }
            else {
                resource = new Leaf_1.Leaf(normalizedUri, this.context);
            }
            this.resourceMap.set(normalizedUri, resource);
        }
        if (options?.autoLoad) {
            resource.read();
        }
        return resource;
    }
}
exports.ResourceStore = ResourceStore;
//# sourceMappingURL=ResourceStore.js.map